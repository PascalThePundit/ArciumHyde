<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arcium Privacy Demo dApp</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .card h2 {
            margin-bottom: 20px;
            color: #64ffda;
            font-size: 1.8rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        input, textarea, button {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        input:focus, textarea:focus {
            outline: 2px solid #64ffda;
            background: rgba(255, 255, 255, 0.15);
        }
        
        button {
            background: linear-gradient(45deg, #00c9ff, #92fe9d);
            color: #1a1a2e;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 201, 255, 0.4);
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.2);
            display: none;
        }
        
        .result.success {
            display: block;
            border-left: 4px solid #4ade80;
        }
        
        .result.error {
            display: block;
            border-left: 4px solid #f87171;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .feature-card h3 {
            color: #64ffda;
            margin-bottom: 10px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            opacity: 0.7;
        }
        
        .status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .balance {
            background: rgba(0, 201, 255, 0.2);
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîí Arcium Privacy Demo dApp</h1>
            <p class="subtitle">Experience the power of Privacy-as-a-Service. Encrypt data, verify attributes, and maintain privacy without exposing sensitive information.</p>
        </header>
        
        <main>
            <div class="card">
                <h2>üîê Data Encryption & Decryption</h2>
                <div class="form-group">
                    <label for="encrypt-data">Data to Encrypt:</label>
                    <textarea id="encrypt-data" placeholder="Enter sensitive data..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="encrypt-password">Password:</label>
                    <input type="password" id="encrypt-password" placeholder="Enter encryption password">
                </div>
                
                <button id="encrypt-btn">Encrypt Data</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="decrypt-data">Encrypted Data:</label>
                    <textarea id="decrypt-data" placeholder="Paste encrypted data..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="decrypt-password">Password:</label>
                    <input type="password" id="decrypt-password" placeholder="Enter decryption password">
                </div>
                
                <button id="decrypt-btn">Decrypt Data</button>
                
                <div id="encrypt-result" class="result"></div>
            </div>
            
            <div class="card">
                <h2>‚úÖ Age Verification (Zero-Knowledge)</h2>
                <div class="form-group">
                    <label for="age-input">Your Age (for demo):</label>
                    <input type="number" id="age-input" placeholder="Enter your age" min="1" max="120">
                </div>
                
                <div class="form-group">
                    <label for="min-age">Minimum Required Age:</label>
                    <input type="number" id="min-age" placeholder="e.g., 18" value="18" min="1" max="100">
                </div>
                
                <button id="verify-age-btn">Generate Age Proof</button>
                
                <div id="age-result" class="result"></div>
            </div>
            
            <div class="card">
                <h2>üí∞ Balance Verification (Zero-Knowledge)</h2>
                <div class="form-group">
                    <label for="balance-input">Account Balance (for demo):</label>
                    <input type="number" id="balance-input" placeholder="Enter your balance" min="0">
                </div>
                
                <div class="form-group">
                    <label for="balance-threshold">Minimum Required Balance:</label>
                    <input type="number" id="balance-threshold" placeholder="e.g., 1000" value="1000" min="0">
                </div>
                
                <button id="check-balance-btn">Generate Balance Proof</button>
                
                <div id="balance-result" class="result"></div>
            </div>
            
            <div class="card">
                <h2>üìä Account Information</h2>
                <div class="status">
                    <div>API Status: <span id="api-status">Checking...</span></div>
                    <div class="balance">Balance: <span id="account-balance">Loading...</span> credits</div>
                    <div>Usage: <span id="api-usage">Loading...</span> requests</div>
                </div>
                <button id="refresh-btn">Refresh Status</button>
            </div>
        </main>
        
        <div class="features">
            <div class="feature-card">
                <h3>üîê End-to-End Encryption</h3>
                <p>Securely encrypt sensitive data using industry-standard algorithms without exposing it to third parties.</p>
            </div>
            <div class="feature-card">
                <h3>üîç Zero-Knowledge Proofs</h3>
                <p>Prove facts about your data without revealing the underlying information.</p>
            </div>
            <div class="feature-card">
                <h3>üìã Selective Disclosure</h3>
                <p>Control exactly what information you share and with whom.</p>
            </div>
        </div>
        
        <footer>
            <p>Powered by Arcium Privacy-as-a-Service API | Secure, Private, and Developer-Friendly</p>
        </footer>
    </div>

    <script>
        // API base URL - in a real app this would be configured
        const API_BASE = '/api';
        
        // DOM Elements
        const encryptBtn = document.getElementById('encrypt-btn');
        const decryptBtn = document.getElementById('decrypt-btn');
        const verifyAgeBtn = document.getElementById('verify-age-btn');
        const checkBalanceBtn = document.getElementById('check-balance-btn');
        const refreshBtn = document.getElementById('refresh-btn');
        
        // Event Listeners
        encryptBtn.addEventListener('click', handleEncrypt);
        decryptBtn.addEventListener('click', handleDecrypt);
        verifyAgeBtn.addEventListener('click', handleAgeVerification);
        checkBalanceBtn.addEventListener('click', handleBalanceCheck);
        refreshBtn.addEventListener('click', updateAccountInfo);
        
        // Initialize
        updateAccountInfo();
        
        // Handle encryption
        async function handleEncrypt() {
            const data = document.getElementById('encrypt-data').value;
            const password = document.getElementById('encrypt-password').value;
            const resultDiv = document.getElementById('encrypt-result');
            
            if (!data || !password) {
                showResult(resultDiv, 'Please enter both data and password', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/encrypt`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data, password })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    document.getElementById('decrypt-data').value = JSON.stringify(result.data.encryptedData);
                    showResult(resultDiv, `Data encrypted successfully! Copy the encrypted data above.`, 'success');
                } else {
                    showResult(resultDiv, result.error || 'Encryption failed', 'error');
                }
            } catch (error) {
                showResult(resultDiv, 'Network error: ' + error.message, 'error');
            }
        }
        
        // Handle decryption
        async function handleDecrypt() {
            const encryptedDataStr = document.getElementById('decrypt-data').value;
            const password = document.getElementById('decrypt-password').value;
            const resultDiv = document.getElementById('encrypt-result');
            
            if (!encryptedDataStr || !password) {
                showResult(resultDiv, 'Please enter both encrypted data and password', 'error');
                return;
            }
            
            try {
                let encryptedData;
                try {
                    encryptedData = JSON.parse(encryptedDataStr);
                } catch {
                    showResult(resultDiv, 'Invalid encrypted data format', 'error');
                    return;
                }
                
                const response = await fetch(`${API_BASE}/decrypt`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ encryptedData, password })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showResult(resultDiv, `Decrypted data: ${result.data}`, 'success');
                } else {
                    showResult(resultDiv, result.error || 'Decryption failed', 'error');
                }
            } catch (error) {
                showResult(resultDiv, 'Network error: ' + error.message, 'error');
            }
        }
        
        // Handle age verification
        async function handleAgeVerification() {
            const age = parseInt(document.getElementById('age-input').value);
            const minAge = parseInt(document.getElementById('min-age').value);
            const resultDiv = document.getElementById('age-result');
            
            if (isNaN(age) || isNaN(minAge)) {
                showResult(resultDiv, 'Please enter valid ages', 'error');
                return;
            }
            
            if (age < 0 || age > 120 || minAge < 0 || minAge > 120) {
                showResult(resultDiv, 'Please enter ages between 0 and 120', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/verify-age`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ age, minAge })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const message = result.verified 
                        ? `‚úÖ Age verification successful! Proof generated that you are at least ${minAge} years old without revealing your exact age.`
                        : `‚ùå Age verification failed! You must be at least ${minAge} years old.`;
                    
                    showResult(resultDiv, message, result.verified ? 'success' : 'error');
                } else {
                    showResult(resultDiv, result.error || 'Age verification failed', 'error');
                }
            } catch (error) {
                showResult(resultDiv, 'Network error: ' + error.message, 'error');
            }
        }
        
        // Handle balance check
        async function handleBalanceCheck() {
            const balance = parseFloat(document.getElementById('balance-input').value);
            const threshold = parseFloat(document.getElementById('balance-threshold').value);
            const resultDiv = document.getElementById('balance-result');
            
            if (isNaN(balance) || isNaN(threshold)) {
                showResult(resultDiv, 'Please enter valid balances', 'error');
                return;
            }
            
            if (balance < 0 || threshold < 0) {
                showResult(resultDiv, 'Balances must be positive', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/check-balance`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ balance, threshold })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const message = result.verified 
                        ? `‚úÖ Balance verification successful! Proof generated that your balance is at least $${threshold} without revealing the exact amount.`
                        : `‚ùå Balance verification failed! Your balance is less than $${threshold}.`;
                    
                    showResult(resultDiv, message, result.verified ? 'success' : 'error');
                } else {
                    showResult(resultDiv, result.error || 'Balance check failed', 'error');
                }
            } catch (error) {
                showResult(resultDiv, 'Network error: ' + error.message, 'error');
            }
        }
        
        // Update account information
        async function updateAccountInfo() {
            try {
                // Update API status
                document.getElementById('api-status').textContent = 'Connected';
                document.getElementById('api-status').style.color = '#4ade80';
                
                // Get balance
                const balanceResponse = await fetch(`${API_BASE}/balance`);
                const balanceResult = await balanceResponse.json();
                
                if (balanceResult.success) {
                    document.getElementById('account-balance').textContent = balanceResult.data.balance;
                } else {
                    document.getElementById('account-balance').textContent = 'Error';
                }
                
                // Get usage
                const usageResponse = await fetch(`${API_BASE}/usage`);
                const usageResult = await usageResponse.json();
                
                if (usageResult.success) {
                    document.getElementById('api-usage').textContent = usageResult.data.totalOperations;
                } else {
                    document.getElementById('api-usage').textContent = 'Error';
                }
            } catch (error) {
                document.getElementById('api-status').textContent = 'Disconnected';
                document.getElementById('api-status').style.color = '#f87171';
                document.getElementById('account-balance').textContent = 'Error';
                document.getElementById('api-usage').textContent = 'Error';
            }
        }
        
        // Helper function to show results
        function showResult(element, message, type) {
            element.textContent = message;
            element.className = `result ${type}`;
            element.style.display = 'block';
            
            // Auto-hide success messages after 10 seconds
            if (type === 'success') {
                setTimeout(() => {
                    element.style.display = 'none';
                }, 10000);
            }
        }
    </script>
</body>
</html>